
/* --- VISUAL THEME --- */
:root {
    --bg-body: #f8fafc; --bg-sidebar: #ffffff; --bg-panel: #ffffff; --bg-card: #f1f5f9;
    --bg-input: #e2e8f0; --border: #cbd5e1; --text-main: #0f172a; --text-muted: #64748b;
    --accent: #059669; --accent-dim: rgba(5, 150, 105, 0.1);
    --danger: #dc2626; --warning: #d97706; --info: #2563eb; --rad: #9333ea; --money: #059669;
    --plan: #7c3aed; --comp: #475569;
    --navy: #1e40af; --navy-dim: #dbeafe;
    --cmd: #7e22ce; --cmd-dim: #f3e8ff; 
    --other: #475569; --other-dim: #f1f5f9;
    --col-plan: #f3f4f6; --col-act: #ecfdf5; --col-rev: #eff6ff; --col-comp: #e2e8f0;
}
[data-theme="dark"] {
    --bg-body: #0f172a; --bg-sidebar: #1e293b; --bg-panel: #1e293b; --bg-card: #334155;
    --bg-input: #020617; --border: #475569; --text-main: #f8fafc; --text-muted: #94a3b8;
    --accent: #10b981; --accent-dim: rgba(16, 185, 129, 0.15);
    --danger: #ef4444; --warning: #f59e0b; --info: #3b82f6; --rad: #d946ef; --money: #34d399;
    --plan: #8b5cf6; --comp: #94a3b8;
    --navy: #60a5fa; --navy-dim: #1e3a8a;
    --cmd: #c084fc; --cmd-dim: #581c87;
    --other: #94a3b8; --other-dim: #334155;
    --col-plan: #1e293b; --col-act: #064e3b; --col-rev: #1e3a8a; --col-comp: #334155;
}
* { box-sizing: border-box; outline: none; transition: background 0.2s, color 0.2s; }
body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, monospace; background: var(--bg-body); color: var(--text-main); display: grid; grid-template-columns: 240px 1fr 300px; grid-template-rows: 100vh; overflow: hidden; }

.live-edit { min-width: 60px; } /* Prevent total collapse */
td input.live-edit[style*="flex:1"] { min-width: 150px !important; } /* Force description to be readable */

.mobile-only { display: none !important; } /* Default hidden on desktop */

/* Sticky Table Headers */
.sci-table th {
    position: sticky;
    top: 0;
    background: var(--bg-panel); /* Matches theme (Dark/Light) */
    z-index: 4;
    box-shadow: 0 1px 0 var(--border); /* subtle border line */
}

/* Responsive */
@media (max-width: 1100px) { body { grid-template-columns: 200px 1fr; grid-template-rows: 1fr auto; } .chat-panel { grid-column: 2; grid-row: 2; border-left: none; border-top: 1px solid var(--border); height: 300px; } .main { grid-column: 2; grid-row: 1; } }

/* --- MOBILE OPTIMIZATION (Polished) --- */
@media (max-width: 768px) { 
    body { 
        display: block; 
        height: auto; 
        overflow-y: auto; 
        overscroll-behavior-y: none; 
    } 

    .desktop-only, 
    button[onclick="toggleProjView()"] { 
        display: none !important; 
    }

    /* --- BOTTOM NAV BAR --- */
    .sidebar { 
        position: fixed; 
        bottom: 0; left: 0; 
        width: 100%; 
        height: auto; /* Let padding define height */
        z-index: 999; 
        display: block; /* Block layout to contain the scrolling wrapper */
        padding: 0;
        
        background: rgba(255, 255, 255, 0.96); /* High quality blur base */
        backdrop-filter: blur(12px); 
        -webkit-backdrop-filter: blur(12px);
        border-top: 1px solid rgba(0,0,0,0.08);
        box-shadow: 0 -4px 25px rgba(0,0,0,0.05);
        
        /* Support for iPhone Home Bar */
        padding-bottom: env(safe-area-inset-bottom, 20px); 
    }

    /* --- SCROLL INDICATORS (Mobile Bottom Bar) --- */
    .sidebar::before,
    .sidebar::after {
        content: '';
        position: absolute;
        top: 50%;
        transform: translateY(-60%); /* Center vertically (offset for safe-area) */
        
        height: 40%; /* Slightly shorter for a cleaner look */
        width: 4px;  /* Slimmer */
        border-radius: 10px;
        opacity: 0.8;
        
        z-index: 1001;
        pointer-events: none; /* Clicks pass through */
    }

    /* Left Indicator (Blue) */
    .sidebar::before {
        left: 8px;
        background-color: var(--info); /* Fixed: Now Blue */
        box-shadow: 1px 0 6px rgba(37, 99, 235, 0.4); 
    }

    /* Right Indicator (Green) */
    .sidebar::after {
        right: 8px;
        background-color: var(--accent); /* Fixed: Now Green */
        box-shadow: -1px 0 6px rgba(5, 150, 105, 0.4); 
    }

    /* Dark Mode Sidebar */
    [data-theme="dark"] .sidebar {
        background: rgba(30, 41, 59, 0.96);
        border-top: 1px solid rgba(255,255,255,0.08);
    }

    /* --- HORIZONTAL SCROLLING CONTAINER --- */
    /* This overrides the inline 'display: grid' */
    #mobile-nav-wrapper {
        display: flex !important; 
        flex-direction: row;
        align-items: center;
        overflow-x: auto;
        gap: 8px; /* Spacing between icons */
        padding: 12px 15px !important; /* Top/Bottom padding for the bar */
        margin: 0 !important;
        width: 100%;
        
        /* Hide Scrollbar */
        scrollbar-width: none; 
        -ms-overflow-style: none;
        scroll-snap-type: x mandatory; 
    }
    #mobile-nav-wrapper::-webkit-scrollbar { display: none; }

    /* Hide Desktop Elements */
    .sidebar .btn-toggle, .sidebar .sync-box, .sidebar #app-title-display, .sidebar > div:first-child, .sidebar > div:last-child { 
        display: none !important; 
    }

    /* --- NAV ITEMS (Centered & Pill Shape) --- */
    .nav-item { 
        display: flex;
        flex-direction: column; 
        justify-content: center; 
        align-items: center; /* Perfect Horizontal Centering */
        
        flex: 0 0 auto; /* Don't shrink */
        width: 68px;    /* Fixed width touch target */
        height: 56px;   /* Fixed height touch target */
        
        border-radius: 16px; /* Pill/Squircle shape */
        margin: 0;
        color: var(--text-muted);
        transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
        scroll-snap-align: center; 
    }
    
    .nav-item i { 
        font-size: 1.3rem; 
        margin-bottom: 4px; 
        display: block; /* Ensure icon is block for centering */
    }
    
    .nav-item .nav-text {
        font-size: 0.65rem;
        font-weight: 600;
        letter-spacing: 0.3px;
    }
    
    /* Active State - "Glowing Pill" */
    .nav-item.active { 
        color: var(--accent); 
        background: var(--accent-dim);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px var(--accent-dim);
    }

    /* --- LAYOUT ADJUSTMENTS --- */
    .main { 
        padding: 15px; 
        padding-bottom: 120px !important; /* Push content up above taller nav */
        width: 100%;
    }

    /* Fix Header Stacking */
    .header { flex-direction: column; align-items: stretch; gap: 10px; }
    .header input, .header select, .header button, .header .search-bar { width: 100% !important; margin: 0 !important; max-width: none !important; }

    /* Fix Modals to be Full Screen on Mobile */
    .modal { 
        width: 100% !important; height: 100% !important; max-height: 100% !important; 
        border-radius: 0; padding: 15px; padding-bottom: 100px; /* Space for nav */
    }

    /* Chat Panel Overlay */
    .chat-panel { 
        display: none !important; 
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
        z-index: 9999; background: var(--bg-body); padding-bottom: 100px;
    }
    .chat-panel.active { display: flex !important; }

    /* Single Column Grids */
    .dashboard-grid, .input-grid, .mini-fin-grid { grid-template-columns: 1fr !important; }

    /* Show Mobile-Only Items */
    .mobile-only { display: flex !important; }
}

@media (max-width: 768px) { .mobile-only { display: flex !important; } }

/* --- PROFESSIONAL PRINT SUITE --- */

@media print {
    /* 1. Layout & Reset */
    @page { margin: 0.5in; size: landscape; }
    body { 
        display: block; 
        background: white !important; 
        color: black !important; 
        -webkit-print-color-adjust: exact; 
        print-color-adjust: exact;
        height: auto; 
        overflow: visible; 
    }

    /* 2. Hide Interface Elements */
    .sidebar, .chat-panel, .header button, .btn, .btn-sync, .btn-toggle, 
    .search-bar, .modal-overlay, #btnShowComp, .quick-actions, 
    .est-input-row, .date-adder, .nav-item, #bulk-toolbar,
    .btn-rect, .qa-btn, .sort-select, .mobile-only { 
        display: none !important; 
    }

    /* 3. Expand Main Content */
    .main { 
        padding: 0; 
        margin: 0; 
        width: 100%; 
        height: auto; 
        grid-column: 1 / -1; 
        overflow: visible;
    }
    
    .view-section { display: none; }
    .view-section.active { display: block; }

    /* 4. Widget & Table Styling */
    .widget { 
        border: 1px solid #ddd; 
        break-inside: avoid; 
        box-shadow: none; 
        margin-bottom: 20px;
    }
    
    .dashboard-grid { display: block; } /* Stack widgets vertically */
    .dashboard-grid > div { margin-bottom: 20px; page-break-inside: avoid; }

    table { width: 100% !important; border-collapse: collapse; page-break-inside: auto; }
    tr { page-break-inside: avoid; page-break-after: auto; }
    th, td { 
        border: 1px solid #ccc !important; 
        color: black !important; 
        padding: 6px !important;
        font-size: 10pt !important;
    }

    /* 5. Inputs to Text Conversion */
    /* Removes borders/backgrounds from inputs so they look like plain text */
    input, select, textarea, .live-edit, .form-control { 
        border: none !important; 
        background: transparent !important; 
        appearance: none; 
        -webkit-appearance: none; 
        padding: 0; 
        font-size: inherit; 
        color: black !important; 
        font-family: inherit;
        resize: none;
        box-shadow: none !important;
    }
    
    /* Hide placeholders in print */
    ::placeholder { color: transparent; }

    /* 6. Specific Tweaks */
    .rag-dot { border: 1px solid rgba(0,0,0,0.2); } /* Add border to dots so they pop */
    .tag { border: 1px solid #ccc; color: black !important; }
    
    /* Force graphs to print background colors */
    .chart-seg, .progress-fill, .bar-v { 
        print-color-adjust: exact; 
        -webkit-print-color-adjust: exact; 
    }
}

/* Sidebar & Buttons */
.sidebar { background: var(--bg-sidebar); border-right: 1px solid var(--border); padding: 1.5rem; display: flex; flex-direction: column; z-index: 20; overflow-y: auto; }
.nav-item { padding: 0.8rem 0.5rem; margin-bottom: 0.5rem; border-radius: 8px; cursor: pointer; color: var(--text-muted); font-weight: 600; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; gap: 8px; transition: background 0.2s; }
.nav-item:hover { background: var(--bg-card); color: var(--text-main); }
.nav-item.active { background: var(--accent-dim); color: var(--accent); }

.btn-sync, .btn-toggle { width: 100%; padding: 0.6rem; border-radius: 6px; border: 1px solid var(--border); background: var(--bg-card); color: var(--text-main); cursor: pointer; font-size: 0.8rem; font-weight: bold; text-align: left; display: flex; align-items: center; gap: 10px; justify-content: center; margin-bottom: 8px; }
.btn-sync:hover, .btn-toggle:hover { background: var(--accent); color: white; border-color: var(--accent); }

.btn-sync.btn-danger { color: var(--danger); border-color: var(--danger); }
.btn-sync.btn-danger:hover { background: var(--danger); color: white; border-color: var(--danger); }
.btn-sync.btn-ghost { color: var(--text-muted); border-color: transparent; background: transparent; }
.btn-sync.btn-ghost:hover { background: var(--bg-input); color: var(--text-main); border-color: var(--border); }

/* Layout */
.main { padding: 2rem; overflow-y: auto; display: flex; flex-direction: column; }
.header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 10px; }
.dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
.widget { background: var(--bg-panel); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; display: flex; flex-direction: column; margin-bottom: 1.5rem; }
.widget-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; font-size: 0.9rem; font-weight: 700; color: var(--text-muted); text-transform: uppercase; }

/* STICKY HEADERS for all tables */
th {
    position: sticky;
    top: 0;
    background: var(--bg-card); /* Opaque background so text doesn't overlap */
    z-index: 10;
    box-shadow: 0 1px 2px rgba(0,0,0,0.1); /* Subtle shadow line */
}

/* --- CUSTOM ALERT & CONFIRM MODALS --- */
.custom-modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.6); z-index: 2000; /* Higher than normal modals */
    display: none; align-items: center; justify-content: center;
    backdrop-filter: blur(2px);
}
.custom-modal-box {
    background: var(--bg-panel); border: 1px solid var(--border);
    width: 90%; max-width: 400px;
    border-radius: 8px; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    overflow: hidden; animation: popIn 0.2s ease-out;
}
.cm-head {
    padding: 15px 20px; background: var(--bg-card); 
    border-bottom: 1px solid var(--border);
    font-weight: bold; font-size: 1rem; color: var(--text-main);
    display: flex; align-items: center; gap: 10px;
}
.cm-body { padding: 20px; color: var(--text-muted); font-size: 0.95rem; line-height: 1.5; }
.cm-foot {
    padding: 10px 15px; background: var(--bg-input);
    border-top: 1px solid var(--border);
    display: flex; justify-content: flex-end; gap: 10px;
}
.btn-sec { background: transparent; border: 1px solid var(--border); color: var(--text-muted); }
.btn-sec:hover { background: var(--bg-card); color: var(--text-main); }
@keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

/* --- UNIVERSAL SCROLLBAR STYLING --- */
/* Works on Chrome, Edge, Safari */
*::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

*::-webkit-scrollbar-track {
    background: transparent;
}

*::-webkit-scrollbar-thumb {
    background-color: var(--border);
    border-radius: 4px;
    border: 2px solid var(--bg-body); /* Creates padding effect */
}

*::-webkit-scrollbar-thumb:hover {
    background-color: var(--text-muted);
}

/* Updated List Item for better spacing */
        .list-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            background: var(--bg-card); 
            padding: 0.8rem; 
            padding-right: 1rem; /* Ensure space */
            border-radius: 6px; 
            margin-bottom: 5px; 
            cursor: pointer; 
            border-left: 3px solid transparent; 
            font-size: 0.9rem; 
            transition: transform 0.2s; 
            position: relative; 
            overflow: hidden; /* Keeps the overlay inside the rounded corners */
        }

        .list-item:hover { border-left-color: var(--accent); transform: translateX(3px); background: var(--bg-input); }
        
        /* Quick Actions Toolbar Style */
        .quick-actions { 
            display: none; 
            position: absolute; 
            right: 0; top: 0; bottom: 0; /* Stretch full height */
            align-items: center; 
            gap: 8px; 
            padding-right: 10px; 
            padding-left: 20px;
            /* Gradient fade so it blends in smoothly */
            background: linear-gradient(to right, transparent, var(--bg-input) 20%);
            z-index: 6;
        }
        .list-item:hover .quick-actions { display: flex; }
        
        /* Better Looking Action Buttons */
        .qa-btn { 
            width: 30px; height: 30px; /* Fixed square size */
            display: flex; align-items: center; justify-content: center;
            font-size: 0.9rem; 
            background: var(--bg-panel); 
            border: 1px solid var(--border); 
            border-radius: 50%; /* Circle buttons look cleaner */
            cursor: pointer; 
            color: var(--text-muted); 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }
        .qa-btn:hover { transform: scale(1.1); color: white; border-color: transparent; }
        
        /* Color coding the buttons */
        .qa-btn.qa-task:hover { background: var(--accent); } /* Green for Task */
        .qa-btn.qa-exp:hover { background: var(--money); }   /* Money Green/Teal for Expense */

        /* Elements */
        .rag-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px; }
        .chart-container { display: flex; height: 20px; border-radius: 4px; overflow: hidden; background: var(--bg-input); margin-top: 10px; }
        .chart-seg { height: 100%; transition: width 0.5s; position: relative; }
        .chart-legend { display: flex; gap: 15px; margin-top: 5px; font-size: 0.7rem; color: var(--text-muted); flex-wrap: wrap; }
        .legend-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .progress-bar { height: 6px; background: var(--bg-input); border-radius: 3px; width: 100px; overflow: hidden; margin-top: 5px; }
        .progress-fill { height: 100%; background: var(--accent); }
        .tag { font-size:0.65rem; padding:2px 6px; border-radius:4px; background:var(--bg-body); border:1px solid var(--border); color:var(--text-muted); margin-left:5px; }
        .proj-link { color:var(--info); font-weight:bold; cursor:pointer; text-decoration:none; }
        .proj-link:hover { text-decoration:underline; color:var(--accent); }

/* Small Rectangle Button */
.btn-rect {
    appearance: none;
    background: var(--bg-input);
    border: 1px solid var(--border);
    border-radius: 4px; /* Rectangle with slight curve */
    padding: 0 12px;
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--text-muted);
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    height: 24px; /* Match sort-select height */
    transition: all 0.2s;
}
.btn-rect:hover {
    border-color: var(--accent);
    background: var(--bg-card);
}

/* Sort Dropdown Style */
.sort-select {
    appearance: none;
    -webkit-appearance: none; 
    background-color: var(--bg-input); /* Use background-color, not 'background' shorthand */
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 2px 8px;
    padding-right: 18px; 
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--text-main); 
    
    cursor: pointer;
    text-align: center;
    outline: none;
    height: 24px; 
    line-height: 1;
    
    /* Only animate colors, stopping the "Floaty Arrow" bug */
    transition: border-color 0.2s, background-color 0.2s, color 0.2s;
    
    /* Arrow Icon */
    background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2364748b%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
    background-repeat: no-repeat;
    background-position: right 5px center;
    background-size: 8px auto;
}

/* Explicit Hover State to keep arrow visible */
.sort-select:hover {
    border-color: var(--text-muted);
    background-color: var(--bg-card);
}

/* Clean up the dropdown options */
option {
    background: var(--bg-panel);
    color: var(--text-main);
    padding: 4px;
}

/* --- GRAVEYARD THEME --- */
@keyframes floatGhost {
    0% { transform: translateY(0px); opacity: 0.7; }
    50% { transform: translateY(-10px); opacity: 1; }
    100% { transform: translateY(0px); opacity: 0.7; }
}
@keyframes flyBat {
    0% { transform: translate(0, 0) rotate(0deg); }
    25% { transform: translate(10px, -15px) rotate(10deg); }
    50% { transform: translate(0, -5px) rotate(0deg); }
    75% { transform: translate(-10px, -15px) rotate(-10deg); }
    100% { transform: translate(0, 0) rotate(0deg); }
}
.gy-icon { color: var(--text-muted); opacity: 0.5; }
.gy-stat { font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }

/* --- STICKY ACTION COLUMN --- */
/* Pin the last column (Actions) to the right side */
#table-inv th:last-child,
#table-inv td:last-child {
    position: sticky;
    right: 0;
    background: var(--bg-panel); /* Opaque background to hide scrolling text behind it */
    z-index: 5;
    border-left: 2px solid var(--border); /* Visual separator */
    box-shadow: -2px 0 5px rgba(0,0,0,0.05);
}

/* Ensure the header stays on top of the sticky column when scrolling down */
#table-inv th:last-child {
    z-index: 11; 
}

.chart-wrapper { 
    display: flex; 
    gap: 10px; 
    height: 180px; 
    width: 100%; 
    border: 1px solid var(--border); 
    background: var(--bg-card); 
    padding: 10px; 
    border-radius: 8px; 
}
        /* Fixed Y-Axis Column */
        .chart-y-axis { 
            display: flex; flex-direction: column; justify-content: space-between; 
            height: 100%; padding-bottom: 25px; /* Align with bars */
            padding-top: 15px;
            min-width: 50px; text-align: right; border-right: 1px dashed var(--border); 
            font-size: 0.65rem; color: var(--text-muted); font-weight: bold;
        }

        /* Scrollable Bar Area */
        .bar-chart-v { 
            display: flex; gap: 12px; height: 100%; width: 100%;
            padding-top: 20px; /* Space for labels */
            overflow-x: auto; overflow-y: hidden;
            scrollbar-width: thin; scrollbar-color: var(--accent) var(--bg-input);
        }

        /* Bars & Labels */
        .bar-col { 
            display: flex; flex-direction: column; align-items: center; justify-content: flex-end; 
            height: 100%; flex-shrink: 0; 
            min-width: 80px; /* Increased buffer spacing */
            position: relative; 
        }
        
        .bar-v { 
            width: 100%; background: var(--money); border-radius: 4px 4px 0 0; 
            min-height: 2px; transition: height 0.3s; opacity: 0.85; position: relative;
        }
        .bar-v:hover { opacity: 1; background: var(--accent); }

        /* The Dollar Amount on Top */
        .bar-top-lbl {
            position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
            font-size: 0.6rem; font-weight: bold; color: var(--text-main);
            margin-bottom: 4px; white-space: nowrap;
        }

        .bar-lbl { 
            font-size: 0.7rem; 
            color: var(--text-main); 
            font-weight: bold; 
            margin-top: 10px; 
            white-space: nowrap; 
            text-align: center; 
            width: 100%;
        }

	.modal .chart-wrapper {
            height: 100% !important; 
            border: none;
            padding: 20px;
        }

        /* --- FUNDING CARDS --- */
        .fund-card {
            background: var(--bg-input); border-radius: 6px; padding: 12px; margin-bottom: 10px;
            border-left: 4px solid var(--text-muted); transition: transform 0.2s;
        }
        .fund-card:hover { transform: translateX(5px); background: var(--bg-card); border: 1px solid var(--border); border-left-width: 4px; }
        .fund-head { display: flex; justify-content: space-between; font-size: 0.8rem; font-weight: bold; margin-bottom: 5px; }
        .fund-meta { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--text-muted); margin-bottom: 8px; }
        .fund-bar-bg { height: 8px; background: rgba(0,0,0,0.1); border-radius: 4px; overflow: hidden; }
        .fund-bar-fill { height: 100%; border-radius: 4px; }

        /* Kanban */
        .kanban-board { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; align-items: start; }
        .kanban-col { background: var(--bg-input); border-radius: 8px; padding: 10px; min-height: 200px; transition: background 0.2s; border: 2px solid transparent; }
        .kanban-col.drag-over { border-color: var(--accent); background: var(--bg-card); }
        .kanban-head { font-weight: 800; font-size: 0.85rem; text-transform: uppercase; margin-bottom: 10px; text-align: center; padding-bottom: 5px; border-bottom: 2px solid; }
        .kanban-card { background: var(--bg-panel); padding: 10px; border-radius: 6px; margin-bottom: 8px; border: 1px solid var(--border); cursor: grab; transition: transform 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .kanban-card:active { cursor: grabbing; }
        .kanban-card:hover { transform: translateY(-2px); border-color: var(--accent); }
        .kanban-card.over-budget { border-color: var(--danger); border-left: 3px solid var(--danger); }

        /* Finance */
        .fin-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 1rem; margin-bottom: 1rem; }
        .fin-card { padding: 1rem; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border); text-align: center; }
        .fin-card.interactive { cursor: pointer; transition: border-color 0.2s; }
        .fin-card.interactive:hover { border-color: var(--accent); background: var(--bg-input); }
        .fin-val { font-size: 1.2rem; font-weight: bold; color: var(--text-main); margin-top: 5px; white-space: nowrap; }
        .fin-label { font-size: 0.65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        .mini-fin-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .mini-fin-box { background: var(--bg-input); padding: 10px; border-radius: 6px; text-align: center; }
        .mini-fin-val { font-weight: bold; font-size: 1rem; }
        .mini-fin-lbl { font-size: 0.6rem; color: var(--text-muted); text-transform: uppercase; }

        /* Chat */
        .chat-panel { background: var(--bg-panel); border-left: 1px solid var(--border); display: flex; flex-direction: column; }
        .chat-header { padding: 1.5rem; border-bottom: 1px solid var(--border); font-weight: bold; color: var(--text-muted); }
        .chat-feed { flex: 1; overflow-y: auto; padding: 1rem; }
        .chat-input-area { padding: 1rem; border-top: 1px solid var(--border); background: var(--bg-sidebar); }
        .msg { background: var(--bg-card); padding: 0.8rem; border-radius: 8px; margin-bottom: 1rem; font-size: 0.85rem; border: 1px solid var(--border); }
        .msg-meta { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.7rem; color: var(--text-muted); }

        /* Inputs */
        .form-control { width: 100%; padding: 0.7rem; background: var(--bg-input); border: 1px solid var(--border); color: var(--text-main); border-radius: 6px; margin-bottom: 1rem; }
        .search-bar { width: 300px; border-radius: 20px; padding: 0.5rem 1rem; border: 1px solid var(--border); background: var(--bg-input); color: var(--text-main); }
        .btn { padding: 0.6rem 1.2rem; border-radius: 6px; border: none; font-weight: 600; cursor: pointer; background: var(--accent); color: white; white-space: nowrap; }
        
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; }
        .modal-overlay.active { display: flex; }
        .modal { background: var(--bg-panel); padding: 2rem; border-radius: 12px; width: 90%; max-width: 500px; border: 1px solid var(--border); max-height: 90vh; overflow-y: auto; }
        
        .view-section { display: none; }
        .view-section.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Tables & Edit */
        .sci-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        .sci-table td, .sci-table th { padding: 8px; border-bottom: 1px solid var(--border); text-align: left; vertical-align: middle; }
        .sci-table th { cursor: pointer; }
        .sci-table th:hover { color: var(--accent); }
        .live-edit { background: transparent; border: 1px solid transparent; width: 100%; padding: 4px; color: inherit; font-family: inherit; font-size: inherit; border-radius: 4px; }
        .live-edit:hover { border-color: var(--border); background: var(--bg-input); }
        .live-edit:focus { border-color: var(--accent); background: var(--bg-card); outline: none; }
        .edit-h1 { font-size: 1.6rem; font-weight: bold; background: transparent; border: 1px solid transparent; width: 100%; color: var(--text-main); margin-bottom: 0.5rem; }
        .edit-h1:hover { border-color: var(--border); }
        .edit-p { width: 100%; background: transparent; border: 1px solid transparent; color: var(--text-muted); font-size: 1rem; resize: vertical; min-height: 60px; font-family: inherit; }
        .edit-p:hover { border-color: var(--border); }

        .task-row { display: flex; align-items: center; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border); }
        .task-chk { cursor: pointer; font-size: 1.2rem; color: var(--text-muted); margin-right: 10px; }
        .task-chk.checked { color: var(--accent); }
        .task-txt.checked { text-decoration: line-through; color: var(--text-muted); }
        .task-input { flex: 1; border: none; background: transparent; color: inherit; font-family: inherit; }
        .assign-select { font-size: 0.7rem; background: var(--bg-input); padding: 2px; border-radius: 4px; color: var(--text-muted); border: 1px solid var(--border); width: 60px; }
        .date-input-mini { font-size: 0.7rem; background: var(--bg-input); padding: 2px; border-radius: 4px; color: var(--text-muted); border: 1px solid var(--border); width: 90px; margin-left:5px; }
        .date-overdue { color: var(--danger); font-weight: bold; border-color: var(--danger); }

        .link-row { display: flex; align-items: center; gap: 10px; padding: 5px; background: var(--bg-input); border-radius: 4px; margin-bottom: 5px; font-size: 0.85rem; }
        .link-row a { color: var(--info); text-decoration: none; overflow: hidden; text-overflow: ellipsis; }
        .input-grid { display: flex; gap: 10px; flex-wrap: wrap; }
        .input-grid > * { flex: 1 1 150px; } 

        /* Toast Notifications */
        .toast-container { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 1000; }
        .toast { background: var(--bg-panel); border-left: 4px solid var(--accent); padding: 12px 20px; border-radius: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); font-size: 0.9rem; display: flex; align-items: center; justify-content: space-between; min-width: 250px; animation: slideIn 0.3s ease-out; color: var(--text-main); }
        .toast.error { border-left-color: var(--danger); }
        .toast.info { border-left-color: var(--info); }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
